{extend name="admin@public/base" /}
{block name="main-content"}
<style>
	.pro_inf>span>p,
	.pro_inf>p{
		color: #ffa64c;
		font-size: 13px;
	}
	.check span input{
		margin-right: 8px;
		margin-left: 15px;
	}
	.check span:nth-child(1) input{
		margin-left: 0;
	}


	#fenleiTankuang div.con{
		display: flex;
		padding: 30px 10px 10px 10px;
		height: 320px;
	}
	#fenleiTankuang div.con>div{
		flex: 1;
		/*border: 1px solid #bbb;*/
		padding: 10px;
		margin-right: 10px;
		border-radius: 3px;
		box-shadow: 0 0 10px #ccc;
	}
	#fenleiTankuang div.con>div ul li{
		color: #555;
		padding: 5px;
		cursor: pointer;
		border-radius: 2px;
		border-bottom: 2px solid #f0f0f0;
	}
	#fenleiTankuang div.con>div ul li.active{
		/*color: #0f6ab4;*/
		background: #dbedf7;
	}
	#fenleiTankuang{
		display: none;
	}
	form>.fenleiCon{
		display: none;
	}
	.dingsClass{
		z-index:20000000!important;
	}
	.inner-content-div2{
		height: 270px;
		overflow-y: scroll;
	}

</style>
<div class="page-content">

	<div class="row maintop">



	</div>

	<div class="row">
		<div class="col-xs-12">
			<div id="step" class="box">
				<form method="post" action="" >
					<div class="form_item">
						<div class="col-xs-5 col-sm-2  margintop5" style="width:50%;margin-left:1200px;position: fixed;">

							<button  class="btn btn-info" id="submit">

								立即上传亚马逊
							</button>
						</div>
					</div>
					<div class="form_item">
						<div class="item">
							<div>
								<h4>
									添加产品
								</h4>
							</div>
							<div class="pro_inf daochu">
			                    <span>
			                        <label for="">
			                            开始ID：
			                        </label>
			                        <input type="text" placeholder="建议填写" class="startId" required="required" id="startId"  οninput="if(value<1)value=1" >
			                        <p>
			                            产品ID都是递增的，本次要导出产品起始ID
			                        </p>
			                    </span>
								&nbsp;&nbsp;&nbsp;&nbsp;
								<span>
			                        <label for="">
			                            结束ID：
			                        </label>
			                        <input type="text" placeholder="建议填写" class="endId" required="required" id="endId">
			                        <p>
			                            要导出产品的结束ID，结束ID起始ID
			                        </p>
			                    </span>
							</div>
						</div>
					</div>
					<div class="form_item">
						<div class="item">
							<div>
								<h4>
									产品id
								</h4>
							</div>
							<div class="pro_inf daochu">
			                    <span>
			                        <textarea name="idText" id="idText"></textarea>
			                        <p>
			                            填写产品ID后（逗号隔开，逗号为英文逗号，不能有空格），将只上传填写的ID列表，不填写则上传其他条件筛选出的产品，标准格式：12,123,456,789
			                        </p>
			                    </span>
							</div>
						</div>
					</div>
					<div class="form-group">
						<div class="item">
							<div>
								<h4>
									所属分类：
								</h4>
							</div>
							<div class="pro_inf daochu">
			                    <span>
			                      <select name="type1" onchange="showclass2()" id="type1">
		                                <option value="">请选择一级分类</option>

		                                    {foreach name="list_fenlei" item="vo"}
		                                    {if condition="$vo.parentId eq 0"}

		                                            <option value="{$vo.categoryId}">{$vo.categoryName}</option>

		                                    {/if}
		                                    {/foreach}
		                            </select>
		                            <select name="type2" onchange="showclass3()" id="type2" style="display:none;"></select>
		                            <select name="type3"  id="type3" style="display:none;"></select>
			                    </span>
								&nbsp;&nbsp;&nbsp;&nbsp;

							</div>
						</div>
					</div>
					<script>
						function showclass2(){
							id = $('#type1').val();
							if(id!=''){
								$.post("{:url('admin/Productclass/showclass22')}",{id:id},function(data){
									if(data!=""){
										$("#type2").html(data);
										$("#type3").html('');
										$("#type2").show();
										$("#type3").hide();
									}else{
										$("#type2").hide();
									}
								});

							}

						}
						function showclass3(){
							id = $('#type2').val();
							if(id!=''){
								$.post("{:url('admin/Productclass/showclass33')}",{id:id},function(data){
									$("#type3").html(data);
									$("#type3").show();
								});
							}
						}
						$('#startId').blur(function(){
							if($('#startId').val()>0 || $('#endId').val()>0){
								$('#idText').text('')
								$('#idText').attr("disabled","disabled");
							}else{
								$('#idText').removeAttr("disabled");
							}
						})
						$('#endId').blur(function(){
							if($('#endId').val()>0 || $('#endId').val()>0){
								$('#idText').text('')
								$('#idText').attr("disabled","disabled");
							}else{
								$('#idText').removeAttr("disabled");
							}
						})
						$('#idText').blur(function(){
							if($('#idText').val()!=""){
								$('#endId').val('')
								$('#startId').val('')
								$('#startId').attr("disabled","disabled");
								$('#endId').attr("disabled","disabled");
							}else{
								$('#endId').removeAttr("disabled");
								$('#startId').removeAttr("disabled");
							}

						})
					</script>
					<div class="form_item">
						<div class="item">
							<div>
								<h4>
									授权店铺
								</h4>
							</div>
							<div class="pro_inf">
								<div class="el-select">
									<!---->
									<div class="el-input el-input--suffix">
										<!---->

										<!---->
										<select name="goodsCate"  class="col-sm-5 selector" required id="test111" onchange="fenlei(this.value)" >
											<option value="">请选择店铺</option>
											{foreach name="storeList" item="v"}
											{if $v['plug_khqy'] == 1}
											<option value="4">{$v.plug_dpbm}--德国</option>
											<option value="5">{$v.plug_dpbm}--英国</option>
											<option value="6">{$v.plug_dpbm}--意大利</option>
											<option value="7">{$v.plug_dpbm}--法国</option>
											<option value="8">{$v.plug_dpbm}--西班牙</option>
											{/if}
											{if $v['plug_khqy'] == 0}
											<option value="9" style="color:blue;">{$v.plug_dpbm}--美国</option>
											<option value="10" style="color:blue;">{$v.plug_dpbm}--墨西哥</option>
											<option value="11" style="color:blue;">{$v.plug_dpbm}--加拿大</option>
											{/if}
											{if $v['plug_khqy'] == 2}
											<option value="2" style="color:green;">{$v.plug_dpbm}--日本</option>
											{/if}
											{/foreach}
										</select>
										<span class="el-input__suffix">
                                                    <span class="el-input__suffix-inner">
                                                        <i class="el-select__caret el-input__icon el-icon-arrow-up">
                                                        </i>

                                </span>
											<!---->
                            </span>
										<!---->
										<!---->
									</div>

								</div>
								<span>
                    </span>
							</div>
						</div>
					</div>

					<div class="form_item">
						<div class="item">
							<div class="select-res">
								<h4>
									选择分类
								</h4>
							</div>

							<!--/*********************************************************************/-->
							<div class="layui-layer layui-layer-page openClass layer-anim" id="layui-layer2" type="page" times="2" showtime="0" contype="object" style="z-index: 19891016; width: 800px; height: 400px;  left: 551.5px;display:none;" >
								<div id="" class="layui-layer-content" style="height: 347px;">
									<div id="fenleiTankuang" class="layui-layer-wrap" style="display: block;">
										<div class="con" id="fenleiContent">
											<div class="fenleiCon" style="display: none;" id="class1">
												<div style="width: 100%; margin: 0px auto;">
													<div class="inner-content-div2">
														<ul id="class1-1">

														</ul>
													</div>
												</div>
											</div>
											<!--												<div class="fenleiCon" style="display: none;" id="class2">-->
											<!--													<div style="width: 100%; margin: 0px auto;">-->
											<!--														<div class="inner-content-div2">-->
											<!--															<ul id="class2-2">-->

											<!--															</ul>-->
											<!--														</div>-->
											<!--													</div>-->
											<!--												</div>-->
											<!--												<div class="fenleiCon"  style="display: none;" id="class3">-->
											<!--													<div style="width: 100%; margin: 0px auto;">-->
											<!--														<div class="inner-content-div2">-->
											<!--															<ul id="class3-3">-->

											<!--															</ul>-->
											<!--														</div>-->
											<!--													</div>-->
											<!--												</div>-->
										</div>
									</div>
								</div>
								<span class="layui-layer-setwin">
                        <a class="layui-layer-ico layui-layer-close layui-layer-close2" onclick="guanbi()">
                        </a>
                    </span> <input type="hidden" id="categoryName">
								<div class="layui-layer-btn layui-layer-btn-">
									<a class="layui-layer-btn0" id="confirmNodeid">
										确定
									</a>
									<a class="layui-layer-btn1" onclick="guanbi()">
										取消
									</a>
								</div>
								<span class="layui-layer-resize">
                    </span>
							</div>
							<script>
								// $.ajaxPrefilter(function( options, originalOptions, jqXHR ) {
								//   if ( options.abortOnRetry ) {
								//     if ( currentRequests[ options.url ] ) {
								//       currentRequests[ options.url ].abort();
								//     }
								//     currentRequests[ options.url ] = jqXHR;
								//   }
								// });
								//关闭分类
								function guanbi(){
									$('#layui-layer2').hide();

								}
								//点击更改背景

								$("#class1-1").on("click","li",function(){
									$("#class1-1 li").removeClass("active");
									$(this).addClass("active");
								});
								$("#class2-2").on("click","li",function(){
									$("#class2-2 li").removeClass("active");
									$(this).addClass("active");
								});
								$("#class3-3").on("click","li",function(){
									$("#class3-3 li").removeClass("active");
									$(this).addClass("active");
								});
								//显示分类
								function xianshi(){

									zhi = $('#test111').val();//选中的值
									if(zhi == ''){
										layer.alert('请选择店铺', {icon: 5});
									}else{
										$('#layui-layer2').show();
									}


								}
								//历史选择
								function history() {
									$("#histroy").empty();
									$('#layui-layer333').show('')
									obj1 = jQuery("#test111  option:selected").val();
									$.ajax({
										url:'{:url(\'admin/Product/historyClass\')}',
										data:{country:obj1},
										type:'post',
										dataType: 'json',
										success:function(result){
											if(result.msg == 'success'){
												$.each(result.data, function(i, item) {
													$("#histroy").append("<li onclick='fuzhi("  + item.id + ")' data-index=\"0\" data-nodeid='"  + item.node_id + "' data-categoryname='" + item.category_name + "' class=' typelist'>" + item.category + "</li>");
												});
											}

										}
									},'json');

								}
								//历史记录赋值
								function fuzhi(idss) {
									$.ajax({
										url:'{:url(\'admin/Product/historyId\')}',
										data:{fid:idss},
										type:'post',
										dataType: 'json',
										success:function(result){
											if(result.msg == 'success'){
												$("#showNode").val(result.data.category);
												$("#categoryName").val(result.data.category_name);
												$("#nodeId").val(result.data.node_id);
											}

										}
									},'json');
								}
								//遍历展示一级分类
								function fenlei(obj) {

									$("#class1").nextAll().remove();

									$('#showNode').val('')

									$('#nodeId').val('')
									$.ajax({
										url:'{:url(\'admin/Feed/firstClass\')}',
										data:{country:obj},
										type:'post',
										dataType: 'json',
										success:function(result){
											$("#class1").show();
											$("#class1-1").html("")
											if(result.msg == 'success'){
												$.each(result.data, function(i, item) {
													$("#class1-1").append("<li data-index=\"0\" data-nodeid='"  + item.cid + "' data-categoryname='" + item.categoryName + "' class=' typelist'>" + item.displayName + "/"+item.categoryName+ "</li>");
												});
											}

										}
									},'json');
								}
								$("#fenleiTankuang").on("click",".typelist",function(){
									$(this).addClass('active').siblings().removeClass('active')
									$(this).parent().parent().parent().parent().nextAll().remove();
									$('#confirmNodeid').attr("node-id",$(this).attr('data-nodeid'));
									$('#confirmNodeid').attr("text",$(this).html());
									$('#confirmNodeid').attr("category-name",$(this).attr('data-categoryname'));
									var country = $('#test111').val()
									var id = $(this).attr('data-nodeid')
									$.ajax({
										url:'{:url(\'admin/Feed/childClass\')}',
										data:{country:country,parent:id},
										type:'post',
										dataType: 'json',
										success:function(result){
											if(result.msg == 'success'){
												var html = "<div class='fenleiCon'>"
												html+="<div style='width: 100%; margin: 0px auto;'>"
												html+="<div class='inner-content-div2'>"
												html+="<ul>"
												$.each(result.data, function(i, item) {
													html+= "<li data-index='0' data-nodeid='" + item.cid + "' data-categoryname='" + item.categoryName + "' class='typelist'>" + item.displayName + "/"+item.categoryName+"</li>"
												});
												html+="</ul>"
												html+="</div>"
												html+="</div>"
												html+="</div>"
												$('#fenleiContent').append(html)
											}
										}
									},'json');
								})



								$('#confirmNodeid').click(function(){
									$('#layui-layer2').hide()
									$('#nodeId').val($(this).attr('node-id'))
									$('#showNode').val($(this).attr('text'))
									$("#categoryName").val($(this).attr('category-name'))
								})
								$("#submit").click(function(){
									var startId = $(".startId").val()
									var endId = $(".endId").val()
									var idText = $('#idText').val()
									var categoryName = $("#categoryName").val()
									if(startId == '' && endId == '' && idText == ''){
										alert('id不能为空')
										return false;
									}
									if(idText == ''){
										if(startId == ''){
											alert('开始id不能为空')
											return false;
										}
										if(endId == ''){
											alert('结束id不能为空')
											return false;
										}
									}

									var goodsCate = $("#test111").val()
									var nodeId = $("#nodeId").val()
									var templateType = $("#templateType").val()
									var category = $('#showNode').val();
									var class1 = $('#type1').val()
									var class2 = $('#type2').val()
									var class3 = $('#type3').val()
									if(showNode == ''){
										alert('请选择分类')
										return false;
									}

									$.ajax({
										url:'{:url(\'admin/Product/product_insertFeed\')}',
										data:{startId:startId,endId:endId,goodsCate:goodsCate,nodeId:nodeId,templateType:templateType,category:category,class1:class1,class2:class2,class3:class3,idText:idText,categoryName:categoryName},
										type:'post',
										dataType: 'json',
										success:function(result){
											// if(result.status=='error'){}
											alert(result.msg);
											if(result.status=='success'){
												window.location.href = "{:url(\'admin/product/record_list\')}";

											}
											// $("#class1").show();
											// if(result.msg == 'success'){
											// 	$.each(result.data, function(i, item) {
											// 		$("#class1-1").append("<li data-index=\"0\" data-nodeid='" + item.cid + "' class=' typelist'>" + item.displayName + "</li>");
											// 	});
											// }

										}
									},'json');
								})
							</script>
							<script>
								function guanbis() {
									$("#layui-layer333").hide();

								}
								$(".layui-layer-btn111").onclick(function(){
									alert('111');
									$("#layui-layer333").hide();
								});
								$(".layui-layer-btn222").click(function(){
									$("#layui-layer333").hide();
								});
							</script>

							<!-- *********************************************************************/ -->
							<div class="pro_inf">
                    <span>
                        <input type="text" placeholder="--请选择--" class="changeType" style="width: 350px;" onclick="xianshi()" id="showNode">
                    </span>
								<input type="text" placeholder="分类节点id" id="nodeId" name="itemType">
								<a class="btn btn-info" onclick="history()">历史选择</a>
								<p>
								</p>
							</div>
						</div>
						<div class="item">
							<div>
								<h4>
									分类模板
								</h4>
							</div>
							<div class="pro_inf">
                    <span>
                        <div class="el-select">
                            <!---->
                            <div class="el-input el-input--suffix">
                                <!---->

								<select name="templateType"  class="col-sm-3 selector" id="templateType">
									<option value="Home/BedAndBath">家--床和浴室</option>
									<option value="Home/FurnitureAndDecor">家--家具和装饰</option>
									<option value="Home/Kitchen">家--厨房</option>
									<option value="Home/OutdoorLiving">家--户外生活</option>
									<option value="Home/SeedsAndPlants">家--种子和植物</option>
									<option value="Home/Art">家--艺术</option>
									<option value="Home/Fabric">家--布</option>
									<option value="Home/VacuumCleaner">家--吸尘器</option>
									<option value="Home/Mattress">家--床垫</option>
									<option value="Home/Headboard">家--床头板</option>
									<option value="Home/Dresser">家--梳妆台</option>
									<option value="Home/Cabinet">家--内阁</option>
									<option value="Home/Chair">家--椅子</option>
									<option value="Home/Table">家--桌子</option>
									<option value="Home/Bench">家--板凳</option>
									<option value="Home/Sofa">家--沙发</option>
									<option value="Home/Desk">家--书桌</option>
									<option value="Home/FloorCover">家--地板盖</option>
									<option value="Home/Bakeware">家--烤盘</option>
									<option value="Home/Cookware">家--炊具</option>
									<option value="Home/Cutlery">家--刀具</option>
									<option value="Home/Dinnerware">家--餐具</option>
									<option value="Home/Serveware">家--Serveware</option>
									<option value="Home/KitchenTools">家--厨房用具</option>
									<option value="Home/SmallHomeAppliances">家--小型家电</option>
									<option value="Health/HealthMisc">健康--健康杂项</option>
									<option value="Health/PersonalCareAppliances">健康--个人护理用具</option>
									<option value="Health/MedicalSupplies">健康--医疗用品</option>
								</select>

								<!---->
                                <span class="el-input__suffix">
                                    <span class="el-input__suffix-inner">
                                        <i class="el-select__caret el-input__icon el-icon-arrow-up">
                                        </i>

                                    </span>
									<!---->
                                </span>

                            </div>
                            <div class="el-select-dropdown el-popper" style="display: none; min-width: 260px;">
                                <div class="el-scrollbar" style="display: none;">
                                    <div class="el-select-dropdown__wrap el-scrollbar__wrap" style="margin-bottom: -17px; margin-right: -17px;">
                                        <ul class="el-scrollbar__view el-select-dropdown__list">
                                        </ul>
                                    </div>
                                    <div class="el-scrollbar__bar is-horizontal">
                                        <div class="el-scrollbar__thumb" style="transform: translateX(0%);">
                                        </div>
                                    </div>
                                    <div class="el-scrollbar__bar is-vertical">
                                        <div class="el-scrollbar__thumb" style="transform: translateY(0%);">
                                        </div>
                                    </div>
                                </div>
                                <p class="el-select-dropdown__empty">
                                    无数据
                                </p>
                            </div>
                        </div>
                    </span>
							</div>
						</div>
						<!---->
					</div>
					<div id="fenleiTankuang1">
						<div class="con" id="fenleiContent1">
						</div>
					</div>
					<div id="timeUp" style="display: none;">
						<h3>
							定时上传
						</h3>
						<span>
                <label for="">
                    国家
                </label>
                <span>
                </span>
            </span>
						<br>
						<span>
                <label for="">
                    选择时间
                </label>
                <div class="el-date-editor el-input el-input--prefix el-input--suffix el-date-editor--datetime">
                    <!---->
                    <input type="text" autocomplete="off" name="" placeholder="选择日期时间" class="el-input__inner">
                    <span class="el-input__prefix">
                        <i class="el-input__icon el-icon-time">
                        </i>
						<!---->
                    </span>
                    <span class="el-input__suffix">
                        <span class="el-input__suffix-inner">
                            <i class="el-input__icon">
                            </i>
							<!---->
							<!---->
							<!---->
							<!---->
                        </span>
						<!---->
                    </span>
					<!---->
					<!---->
                </div>
            </span>
						<span style="color: rgb(0, 163, 232); cursor: pointer;">
                <i class="layui-icon layui-icon-fonts-code">
                </i>
                转换
            </span>
						<p>
						</p>
					</div>
				</form>
				<!--<div id="lishi" style="display: none;">
                    <h3>
                        历史选择
                    </h3>
                    <div class="some-content-related-div" style="width: 100%; margin: 0px auto;">
                        <div class="inner-content-div2">
                            <ul>
                            </ul>
                        </div>
                    </div>
                </div>-->

				<style>
					#lishi h3{
						margin: 10px;
						color: #00a3e8;
						font-weight: bold;
					}
					#lishi ul{
						margin: 10px;
						padding: 10px;
						border:1px solid #ddd;
						border-radius: 3px;
						height: 255px;
					}
					#lishi ul li{
						padding: 5px;
						border-radius: 3px;
						cursor: pointer;
						list-style:none;
					}
					#lishi ul li:hover , #lishi ul li.active{
						background: #dbedf7;
					}

				</style>
				<div class="layui-layer layui-layer-page openClass layer-anim" id="layui-layer333" type="page" times="2" showtime="0" contype="object" style="z-index: 19891016; width: 800px; height: 400px; top: 32px; left: 441.5px;display: none;">
					<div id="" class="layui-layer-content" style="height: 347px;">
						<div id="lishi" style="" class="layui-layer-wrap">
							<h3>
								历史选择
							</h3>
							<div class="some-content-related-div" style="width: 100%; margin: 0px auto;">
								<div class="inner-content-div2">
									<ul id="histroy">

									</ul>
								</div>
							</div>
						</div>
					</div>
					<span class="layui-layer-setwin">
					<a class="layui-layer-ico layui-layer-close layui-layer-close2  layui-layer-btn222" onclick="guanbis()">
					</a>
				</span>
					<div class="layui-layer-btn layui-layer-btn-">
						<a class="layui-layer-btn111" onclick="guanbis()">
							确定
						</a>
						<a class="layui-layer-btn222" onclick="guanbis()">
							取消
						</a>
					</div>
					<span class="layui-layer-resize">
				</span>
				</div>




			</div>

		</div>
	</div>




	{/block}
	{extend name="admin@public/base" /}
	{block name="main-content"}
	<style>
		.pro_inf>span>p,
		.pro_inf>p{
			color: #ffa64c;
			font-size: 13px;
		}
		.check span input{
			margin-right: 8px;
			margin-left: 15px;
		}
		.check span:nth-child(1) input{
			margin-left: 0;
		}


		#fenleiTankuang div.con{
			display: flex;
			padding: 30px 10px 10px 10px;
			height: 320px;
		}
		#fenleiTankuang div.con>div{
			flex: 1;
			/*border: 1px solid #bbb;*/
			padding: 10px;
			margin-right: 10px;
			border-radius: 3px;
			box-shadow: 0 0 10px #ccc;
		}
		#fenleiTankuang div.con>div ul li{
			color: #555;
			padding: 5px;
			cursor: pointer;
			border-radius: 2px;
			border-bottom: 2px solid #f0f0f0;
		}
		#fenleiTankuang div.con>div ul li.active{
			/*color: #0f6ab4;*/
			background: #dbedf7;
		}
		#fenleiTankuang{
			display: none;
		}
		form>.fenleiCon{
			display: none;
		}
		.dingsClass{
			z-index:20000000!important;
		}
		.inner-content-div2{
			height: 270px;
			overflow-y: scroll;
		}

	</style>
	<div class="page-content">

		<div class="row maintop">



		</div>

		<div class="row">
			<div class="col-xs-12">
				<div id="step" class="box">
					<form method="post" action="" >
						<div class="form_item">
							<div class="col-xs-5 col-sm-2  margintop5" style="width:50%;margin-left:1200px;position: fixed;">

								<button  class="btn btn-info" id="submit">

									立即上传亚马逊
								</button>
							</div>
						</div>
						<div class="form_item">
							<div class="item">
								<div>
									<h4>
										添加产品
									</h4>
								</div>
								<div class="pro_inf daochu">
			                    <span>
			                        <label for="">
			                            开始ID：
			                        </label>
			                        <input type="text" placeholder="建议填写" class="startId" required="required" id="startId"  οninput="if(value<1)value=1" >
			                        <p>
			                            产品ID都是递增的，本次要导出产品起始ID
			                        </p>
			                    </span>
									&nbsp;&nbsp;&nbsp;&nbsp;
									<span>
			                        <label for="">
			                            结束ID：
			                        </label>
			                        <input type="text" placeholder="建议填写" class="endId" required="required" id="endId">
			                        <p>
			                            要导出产品的结束ID，结束ID起始ID
			                        </p>
			                    </span>
								</div>
							</div>
						</div>
						<div class="form_item">
							<div class="item">
								<div>
									<h4>
										产品id
									</h4>
								</div>
								<div class="pro_inf daochu">
			                    <span>
			                        <textarea name="idText" id="idText"></textarea>
			                        <p>
			                            填写产品ID后（逗号隔开，逗号为英文逗号，不能有空格），将只上传填写的ID列表，不填写则上传其他条件筛选出的产品，标准格式：12,123,456,789
			                        </p>
			                    </span>
								</div>
							</div>
						</div>
						<div class="form-group">
							<div class="item">
								<div>
									<h4>
										所属分类：
									</h4>
								</div>
								<div class="pro_inf daochu">
			                    <span>
			                      <select name="type1" onchange="showclass2()" id="type1">
		                                <option value="">请选择一级分类</option>

		                                    {foreach name="list_fenlei" item="vo"}
		                                    {if condition="$vo.parentId eq 0"}

		                                            <option value="{$vo.categoryId}">{$vo.categoryName}</option>

		                                    {/if}
		                                    {/foreach}
		                            </select>
		                            <select name="type2" onchange="showclass3()" id="type2" style="display:none;"></select>
		                            <select name="type3"  id="type3" style="display:none;"></select>
			                    </span>
									&nbsp;&nbsp;&nbsp;&nbsp;

								</div>
							</div>
						</div>
						<script>
							function showclass2(){
								id = $('#type1').val();
								if(id!=''){
									$.post("{:url('admin/Productclass/showclass22')}",{id:id},function(data){
										if(data!=""){
											$("#type2").html(data);
											$("#type3").html('');
											$("#type2").show();
											$("#type3").hide();
										}else{
											$("#type2").hide();
										}
									});

								}

							}
							function showclass3(){
								id = $('#type2').val();
								if(id!=''){
									$.post("{:url('admin/Productclass/showclass33')}",{id:id},function(data){
										$("#type3").html(data);
										$("#type3").show();
									});
								}
							}
							$('#startId').blur(function(){
								if($('#startId').val()>0 || $('#endId').val()>0){
									$('#idText').text('')
									$('#idText').attr("disabled","disabled");
								}else{
									$('#idText').removeAttr("disabled");
								}
							})
							$('#endId').blur(function(){
								if($('#endId').val()>0 || $('#endId').val()>0){
									$('#idText').text('')
									$('#idText').attr("disabled","disabled");
								}else{
									$('#idText').removeAttr("disabled");
								}
							})
							$('#idText').blur(function(){
								if($('#idText').val()!=""){
									$('#endId').val('')
									$('#startId').val('')
									$('#startId').attr("disabled","disabled");
									$('#endId').attr("disabled","disabled");
								}else{
									$('#endId').removeAttr("disabled");
									$('#startId').removeAttr("disabled");
								}

							})
						</script>
						<div class="form_item">
							<div class="item">
								<div>
									<h4>
										授权店铺
									</h4>
								</div>
								<div class="pro_inf">
									<div class="el-select">
										<!---->
										<div class="el-input el-input--suffix">
											<!---->

											<!---->
											<select name="goodsCate"  class="col-sm-5 selector" required id="test111" onchange="fenlei(this.value)" >
												<option value="">请选择店铺</option>
												{foreach name="storeList" item="v"}
												{if $v['plug_khqy'] == 1}
												<option value="4">{$v.plug_dpbm}--德国</option>
												<option value="5">{$v.plug_dpbm}--英国</option>
												<option value="6">{$v.plug_dpbm}--意大利</option>
												<option value="7">{$v.plug_dpbm}--法国</option>
												<option value="8">{$v.plug_dpbm}--西班牙</option>
												{/if}
												{if $v['plug_khqy'] == 0}
												<option value="9" style="color:blue;">{$v.plug_dpbm}--美国</option>
												<option value="10" style="color:blue;">{$v.plug_dpbm}--墨西哥</option>
												<option value="11" style="color:blue;">{$v.plug_dpbm}--加拿大</option>
												{/if}
												{if $v['plug_khqy'] == 2}
												<option value="2" style="color:green;">{$v.plug_dpbm}--日本</option>
												{/if}
												{/foreach}
											</select>
											<span class="el-input__suffix">
                                                    <span class="el-input__suffix-inner">
                                                        <i class="el-select__caret el-input__icon el-icon-arrow-up">
                                                        </i>

                                </span>
												<!---->
                            </span>
											<!---->
											<!---->
										</div>

									</div>
									<span>
                    </span>
								</div>
							</div>
						</div>

						<div class="form_item">
							<div class="item">
								<div class="select-res">
									<h4>
										选择分类
									</h4>
								</div>

								<!--/*********************************************************************/-->
								<div class="layui-layer layui-layer-page openClass layer-anim" id="layui-layer2" type="page" times="2" showtime="0" contype="object" style="z-index: 19891016; width: 800px; height: 400px;  left: 551.5px;display:none;" >
									<div id="" class="layui-layer-content" style="height: 347px;">
										<div id="fenleiTankuang" class="layui-layer-wrap" style="display: block;">
											<div class="con" id="fenleiContent">
												<div class="fenleiCon" style="display: none;" id="class1">
													<div style="width: 100%; margin: 0px auto;">
														<div class="inner-content-div2">
															<ul id="class1-1">

															</ul>
														</div>
													</div>
												</div>
												<!--												<div class="fenleiCon" style="display: none;" id="class2">-->
												<!--													<div style="width: 100%; margin: 0px auto;">-->
												<!--														<div class="inner-content-div2">-->
												<!--															<ul id="class2-2">-->

												<!--															</ul>-->
												<!--														</div>-->
												<!--													</div>-->
												<!--												</div>-->
												<!--												<div class="fenleiCon"  style="display: none;" id="class3">-->
												<!--													<div style="width: 100%; margin: 0px auto;">-->
												<!--														<div class="inner-content-div2">-->
												<!--															<ul id="class3-3">-->

												<!--															</ul>-->
												<!--														</div>-->
												<!--													</div>-->
												<!--												</div>-->
											</div>
										</div>
									</div>
									<span class="layui-layer-setwin">
                        <a class="layui-layer-ico layui-layer-close layui-layer-close2" onclick="guanbi()">
                        </a>
                    </span> <input type="hidden" id="categoryName">
									<div class="layui-layer-btn layui-layer-btn-">
										<a class="layui-layer-btn0" id="confirmNodeid">
											确定
										</a>
										<a class="layui-layer-btn1" onclick="guanbi()">
											取消
										</a>
									</div>
									<span class="layui-layer-resize">
                    </span>
								</div>
								<script>
									// $.ajaxPrefilter(function( options, originalOptions, jqXHR ) {
									//   if ( options.abortOnRetry ) {
									//     if ( currentRequests[ options.url ] ) {
									//       currentRequests[ options.url ].abort();
									//     }
									//     currentRequests[ options.url ] = jqXHR;
									//   }
									// });
									//关闭分类
									function guanbi(){
										$('#layui-layer2').hide();

									}
									//点击更改背景

									$("#class1-1").on("click","li",function(){
										$("#class1-1 li").removeClass("active");
										$(this).addClass("active");
									});
									$("#class2-2").on("click","li",function(){
										$("#class2-2 li").removeClass("active");
										$(this).addClass("active");
									});
									$("#class3-3").on("click","li",function(){
										$("#class3-3 li").removeClass("active");
										$(this).addClass("active");
									});
									//显示分类
									function xianshi(){

										zhi = $('#test111').val();//选中的值
										if(zhi == ''){
											layer.alert('请选择店铺', {icon: 5});
										}else{
											$('#layui-layer2').show();
										}


									}
									//历史选择
									function history() {
										$("#histroy").empty();
										$('#layui-layer333').show('')
										obj1 = jQuery("#test111  option:selected").val();
										$.ajax({
											url:'{:url(\'admin/Product/historyClass\')}',
											data:{country:obj1},
											type:'post',
											dataType: 'json',
											success:function(result){
												if(result.msg == 'success'){
													$.each(result.data, function(i, item) {
														$("#histroy").append("<li onclick='fuzhi("  + item.id + ")' data-index=\"0\" data-nodeid='"  + item.node_id + "' data-categoryname='" + item.category_name + "' class=' typelist'>" + item.category + "</li>");
													});
												}

											}
										},'json');

									}
									//历史记录赋值
									function fuzhi(idss) {
										$.ajax({
											url:'{:url(\'admin/Product/historyId\')}',
											data:{fid:idss},
											type:'post',
											dataType: 'json',
											success:function(result){
												if(result.msg == 'success'){
													$("#showNode").val(result.data.category);
													$("#categoryName").val(result.data.category_name);
													$("#nodeId").val(result.data.node_id);
												}

											}
										},'json');
									}
									//遍历展示一级分类
									function fenlei(obj) {

										$("#class1").nextAll().remove();

										$('#showNode').val('')

										$('#nodeId').val('')
										$.ajax({
											url:'{:url(\'admin/Feed/firstClass\')}',
											data:{country:obj},
											type:'post',
											dataType: 'json',
											success:function(result){
												$("#class1").show();
												$("#class1-1").html("")
												if(result.msg == 'success'){
													$.each(result.data, function(i, item) {
														$("#class1-1").append("<li data-index=\"0\" data-nodeid='"  + item.cid + "' data-id='"  + item.nodeId + "' data-categoryname='" + item.categoryName + "' class=' typelist'>" + item.displayName + "/"+item.categoryName+ "</li>");
													});
												}

											}
										},'json');
									}
									$("#fenleiTankuang").on("click",".typelist",function(){
										$(this).addClass('active').siblings().removeClass('active')
										$(this).parent().parent().parent().parent().nextAll().remove();
										$('#confirmNodeid').attr("node-id",$(this).attr('data-id'));
										$('#confirmNodeid').attr("text",$(this).html());
										$('#confirmNodeid').attr("category-name",$(this).attr('data-categoryname'));
										var country = $('#test111').val()
										var id = $(this).attr('data-nodeid')
										$.ajax({
											url:'{:url(\'admin/Feed/childClass\')}',
											data:{country:country,parent:id},
											type:'post',
											dataType: 'json',
											success:function(result){
												if(result.msg == 'success'){
													var html = "<div class='fenleiCon'>"
													html+="<div style='width: 100%; margin: 0px auto;'>"
													html+="<div class='inner-content-div2'>"
													html+="<ul>"
													$.each(result.data, function(i, item) {
														html+= "<li data-index='0' data-nodeid='" + item.cid + "'  data-id='"  + item.nodeId + "' data-categoryname='" + item.categoryName + "' class='typelist'>" + item.displayName + "/"+item.categoryName+"</li>"
													});
													html+="</ul>"
													html+="</div>"
													html+="</div>"
													html+="</div>"
													$('#fenleiContent').append(html)
												}
											}
										},'json');
									})



									$('#confirmNodeid').click(function(){
										$('#layui-layer2').hide()
										$('#nodeId').val($(this).attr('node-id'))
										$('#showNode').val($(this).attr('text'))
										$("#categoryName").val($(this).attr('category-name'))
										var categoryDetail = ""
										$('#fenleiTankuang .active').each(function(index,e){
											categoryDetail += $(this).html()+"/"
										})
										$('#categoryDetail').html(categoryDetail)
									})
									$("#submit").click(function(){
										var startId = $(".startId").val()
										var endId = $(".endId").val()
										var idText = $('#idText').val()
										var categoryName = $("#categoryName").val()
										if(startId == '' && endId == '' && idText == ''){
											alert('id不能为空')
											return false;
										}
										if(idText == ''){
											if(startId == ''){
												alert('开始id不能为空')
												return false;
											}
											if(endId == ''){
												alert('结束id不能为空')
												return false;
											}
										}

										var goodsCate = $("#test111").val()
										var nodeId = $("#nodeId").val()
										var templateType = $("#templateType").val()
										var category = $('#showNode').val();
										var class1 = $('#type1').val()
										var class2 = $('#type2').val()
										var class3 = $('#type3').val()
										var categoryDetail = $("#categoryDetail").html()
										if(showNode == ''){
											alert('请选择分类')
											return false;
										}

										$.ajax({
											url:'{:url(\'admin/Product/product_insertFeed\')}',
											data:{startId:startId,endId:endId,goodsCate:goodsCate,nodeId:nodeId,templateType:templateType,category:category,class1:class1,class2:class2,class3:class3,idText:idText,categoryName:categoryName,categoryDetail:categoryDetail},
											type:'post',
											dataType: 'json',
											success:function(result){
												// if(result.status=='error'){}
												alert(result.msg);
												if(result.status=='success'){
													//window.location.href = "{:url(\'admin/product/record_list\')}";
													window.location.reload();

												}
												// $("#class1").show();
												// if(result.msg == 'success'){
												// 	$.each(result.data, function(i, item) {
												// 		$("#class1-1").append("<li data-index=\"0\" data-nodeid='" + item.cid + "' class=' typelist'>" + item.displayName + "</li>");
												// 	});
												// }

											}
										},'json');


									})
								</script>
								<script>
									function guanbis() {
										$("#layui-layer333").hide();

									}
									$(".layui-layer-btn111").click(function(){
										alert('111');
										$("#layui-layer333").hide();
									});
									$(".layui-layer-btn222").click(function(){
										$("#layui-layer333").hide();
									});
								</script>

								<!-- *********************************************************************/ -->
								<div class="pro_inf">
                    <span>
                        <input type="text" placeholder="--请选择--" class="changeType" style="width: 350px;" onclick="xianshi()" id="showNode">
                    </span>
									<input type="text" placeholder="分类节点id" id="nodeId" name="itemType">
									<a class="btn btn-info" onclick="history()">历史选择</a>
									<p id="categoryDetail">
									</p>
									<input type="text" id="searchCategory" placeholder="输入分类搜索" >
									<a class="btn btn-info" id="submitSearch">搜索</a>
									<select  id="searchResult" style="display: none"></select>
								</div>
							</div>
							<div class="item">
								<div>
									<h4>
										分类模板
									</h4>
								</div>
								<div class="pro_inf">
                    <span>
                        <div class="el-select">
                            <!---->
                            <div class="el-input el-input--suffix">
                                <!---->

								<select name="templateType"  class="col-sm-3 selector" id="templateType">
									<option value="Home/BedAndBath">家--床和浴室</option>
									<option value="Home/FurnitureAndDecor">家--家具和装饰</option>
									<option value="Home/Kitchen">家--厨房</option>
									<option value="Home/OutdoorLiving">家--户外生活</option>
									<option value="Home/SeedsAndPlants">家--种子和植物</option>
									<option value="Home/Art">家--艺术</option>
									<option value="Home/Fabric">家--布</option>
									<option value="Home/VacuumCleaner">家--吸尘器</option>
									<option value="Home/Mattress">家--床垫</option>
									<option value="Home/Headboard">家--床头板</option>
									<option value="Home/Dresser">家--梳妆台</option>
									<option value="Home/Cabinet">家--内阁</option>
									<option value="Home/Chair">家--椅子</option>
									<option value="Home/Table">家--桌子</option>
									<option value="Home/Bench">家--板凳</option>
									<option value="Home/Sofa">家--沙发</option>
									<option value="Home/Desk">家--书桌</option>
									<option value="Home/FloorCover">家--地板盖</option>
									<option value="Home/Bakeware">家--烤盘</option>
									<option value="Home/Cookware">家--炊具</option>
									<option value="Home/Cutlery">家--刀具</option>
									<option value="Home/Dinnerware">家--餐具</option>
									<option value="Home/Serveware">家--Serveware</option>
									<option value="Home/KitchenTools">家--厨房用具</option>
									<option value="Home/SmallHomeAppliances">家--小型家电</option>
									<option value="Health/HealthMisc">健康--健康杂项</option>
									<option value="Health/PersonalCareAppliances">健康--个人护理用具</option>
									<option value="Health/MedicalSupplies">健康--医疗用品</option>
								</select>

								<!---->
                                <span class="el-input__suffix">
                                    <span class="el-input__suffix-inner">
                                        <i class="el-select__caret el-input__icon el-icon-arrow-up">
                                        </i>

                                    </span>
									<!---->
                                </span>

                            </div>
                            <div class="el-select-dropdown el-popper" style="display: none; min-width: 260px;">
                                <div class="el-scrollbar" style="display: none;">
                                    <div class="el-select-dropdown__wrap el-scrollbar__wrap" style="margin-bottom: -17px; margin-right: -17px;">
                                        <ul class="el-scrollbar__view el-select-dropdown__list">
                                        </ul>
                                    </div>
                                    <div class="el-scrollbar__bar is-horizontal">
                                        <div class="el-scrollbar__thumb" style="transform: translateX(0%);">
                                        </div>
                                    </div>
                                    <div class="el-scrollbar__bar is-vertical">
                                        <div class="el-scrollbar__thumb" style="transform: translateY(0%);">
                                        </div>
                                    </div>
                                </div>
                                <p class="el-select-dropdown__empty">
                                    无数据
                                </p>
                            </div>
                        </div>
                    </span>
								</div>
							</div>
							<!---->
						</div>
						<div id="fenleiTankuang1">
							<div class="con" id="fenleiContent1">
							</div>
						</div>
						<div id="timeUp" style="display: none;">
							<h3>
								定时上传
							</h3>
							<span>
                <label for="">
                    国家
                </label>
                <span>
                </span>
            </span>
							<br>
							<span>
                <label for="">
                    选择时间
                </label>
                <div class="el-date-editor el-input el-input--prefix el-input--suffix el-date-editor--datetime">
                    <!---->
                    <input type="text" autocomplete="off" name="" placeholder="选择日期时间" class="el-input__inner">
                    <span class="el-input__prefix">
                        <i class="el-input__icon el-icon-time">
                        </i>
						<!---->
                    </span>
                    <span class="el-input__suffix">
                        <span class="el-input__suffix-inner">
                            <i class="el-input__icon">
                            </i>
							<!---->
							<!---->
							<!---->
							<!---->
                        </span>
						<!---->
                    </span>
					<!---->
					<!---->
                </div>
            </span>
							<span style="color: rgb(0, 163, 232); cursor: pointer;">
                <i class="layui-icon layui-icon-fonts-code">
                </i>
                转换
            </span>
							<p>
							</p>
						</div>
					</form>
					<!--<div id="lishi" style="display: none;">
						<h3>
							历史选择
						</h3>
						<div class="some-content-related-div" style="width: 100%; margin: 0px auto;">
							<div class="inner-content-div2">
								<ul>
								</ul>
							</div>
						</div>
					</div>-->

					<style>
						#lishi h3{
							margin: 10px;
							color: #00a3e8;
							font-weight: bold;
						}
						#lishi ul{
							margin: 10px;
							padding: 10px;
							border:1px solid #ddd;
							border-radius: 3px;
							height: 255px;
						}
						#lishi ul li{
							padding: 5px;
							border-radius: 3px;
							cursor: pointer;
							list-style:none;
						}
						#lishi ul li:hover , #lishi ul li.active{
							background: #dbedf7;
						}

					</style>
					<div class="layui-layer layui-layer-page openClass layer-anim" id="layui-layer333" type="page" times="2" showtime="0" contype="object" style="z-index: 19891016; width: 800px; height: 400px; top: 32px; left: 441.5px;display: none;">
						<div id="" class="layui-layer-content" style="height: 347px;">
							<div id="lishi" style="" class="layui-layer-wrap">
								<h3>
									历史选择
								</h3>
								<div class="some-content-related-div" style="width: 100%; margin: 0px auto;">
									<div class="inner-content-div2">
										<ul id="histroy">

										</ul>
									</div>
								</div>
							</div>
						</div>
						<span class="layui-layer-setwin">
					<a class="layui-layer-ico layui-layer-close layui-layer-close2  layui-layer-btn222" onclick="guanbis()">
					</a>
				</span>
						<div class="layui-layer-btn layui-layer-btn-">
							<a class="layui-layer-btn111" onclick="guanbis()">
								确定
							</a>
							<a class="layui-layer-btn222" onclick="guanbis()">
								取消
							</a>
						</div>
						<span class="layui-layer-resize">
				</span>
					</div>




				</div>

			</div>
		</div>
		<script>
			//搜索分类
			$('#submitSearch').click(function(){
				var store = $('#test111').val()
				if(store==""){
					alert("请先选择店铺")
					return false;
				}
				var search = $('#searchCategory').val()
				$("#searchResult").html('')
				$.ajax({
					url:'{:url(\'admin/Product/searchCategory\')}',
					data:{search:search,store:store},
					type:'post',
					dataType: 'json',
					success:function(result){
						console.log(result)
						if(result.msg == 'success'){
							$('#searchResult').show()
							$.each(result.data, function(i, item) {
								$("#searchResult").append("<option  data-nodeid='" + item.cid + "'  data-id='"  + item.nodeId + "' data-categoryname='" + item.categoryName + "' class='searchList'>" + item.displayName + "/"+item.categoryName+"</option>");
							});
						}else{
							alert('未查到相关数据')
						}

					}
				},'json');
			// }
			})
			//搜索结果选中
			$('#searchResult').click(function(){
				var nodeId = $('#searchResult').find("option:selected").attr("data-id")
				var showNode = $('#searchResult').find("option:selected").val()
				var categoryName = $('#searchResult').find("option:selected").attr("data-categoryname")
				$('#categoryDetail').html('')
				$('#nodeId').val(nodeId)
				$('#showNode').val(showNode)
				$("#categoryName").val(categoryName)
			})
		</script>



		{/block}
